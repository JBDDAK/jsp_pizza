CREATE TABLE TBL_PIZZA_01 (
    PCODE CHAR(4) NOT NULL,
    PNAME VARCHAR2(30),
    COST NUMBER(7),
    CONSTARINT PK_PIZZA PRIMARY KEY (PCODE)
);

CREATE TABLE TBL_SHOP_01 (
    SCODE CHAR(4) NOT NULL,
    SNAME VARCHAR2(20),
    CONSTRAINT PK_SHOP PRIMARY KEY (SCODE)
);

CREATE TABLE TBL_SALELIST_01 (
    SALENO NUMBER(7) NOT NULL,
    SCODE CHAR(4) NOT NULL,
    SALEDATE DATE,
    PCODE CHAR(4) NOT NULL,
    AMOUNT NUMBER(5),
    CONSTRAINT PK_SALELIST PRIMARY KEY (SALENO)
);

INSERT INTO TBL_PIZZA_01 VALUES('AA01', '고르골졸라피자', 6000);
INSERT INTO TBL_PIZZA_01 VALUES('AA02', '치즈피자', 6500);
INSERT INTO TBL_PIZZA_01 VALUES('AA03', '페퍼로니피자', 7000);
INSERT INTO TBL_PIZZA_01 VALUES('AA04', '콤비네이션피자', 7500);
INSERT INTO TBL_PIZZA_01 VALUES('AA05', '고구마피자', 6000);
INSERT INTO TBL_PIZZA_01 VALUES('AA06', '토네이도피자', 7000);
INSERT INTO TBL_PIZZA_01 VALUES('AA07', '불고기피자', 8000);
INSERT INTO TBL_PIZZA_01 VALUES('AA08', '나폴리피자', 8000);

INSERT INTO TBL_SHOP_01 VALUES('S001', '강남점');
INSERT INTO TBL_SHOP_01 VALUES('S002', '강서점');
INSERT INTO TBL_SHOP_01 VALUES('S003', '강동점');
INSERT INTO TBL_SHOP_01 VALUES('S004', '영동점');
INSERT INTO TBL_SHOP_01 VALUES('S005', '시청점');
INSERT INTO TBL_SHOP_01 VALUES('S006', '인천점');

INSERT INTO TBL_SALELIST_01 VALUES(100001, 'S001', '2018-12-02', 'AA01', 50);
INSERT INTO TBL_SALELIST_01 VALUES(100002, 'S001', '2018-12-02', 'AA02', 30);
INSERT INTO TBL_SALELIST_01 VALUES(100003, 'S001', '2018-12-02', 'AA03', 20);
INSERT INTO TBL_SALELIST_01 VALUES(100004, 'S001', '2018-12-02', 'AA04', 50);
INSERT INTO TBL_SALELIST_01 VALUES(100005, 'S003', '2018-12-03', 'AA01', 40);
INSERT INTO TBL_SALELIST_01 VALUES(100006, 'S003', '2018-12-03', 'AA02', 60);
INSERT INTO TBL_SALELIST_01 VALUES(100007, 'S003', '2018-12-03', 'AA04', 60);
INSERT INTO TBL_SALELIST_01 VALUES(100008, 'S003', '2018-12-04', 'AA05', 70);
INSERT INTO TBL_SALELIST_01 VALUES(100009, 'S005', '2018-12-02', 'AA01', 80);
INSERT INTO TBL_SALELIST_01 VALUES(100010, 'S005', '2018-12-02', 'AA03', 30);
INSERT INTO TBL_SALELIST_01 VALUES(100011, 'S005', '2018-12-02', 'AA04', 40);
INSERT INTO TBL_SALELIST_01 VALUES(100012, 'S005', '2018-12-02', 'AA05', 50);
INSERT INTO TBL_SALELIST_01 VALUES(100013, 'S004', '2018-12-04', 'AA01', 30);
INSERT INTO TBL_SALELIST_01 VALUES(100014, 'S004', '2018-12-04', 'AA02', 20);
INSERT INTO TBL_SALELIST_01 VALUES(100015, 'S004', '2018-12-04', 'AA06', 50);

SELECT SALELIST.SALENO, SHOP.SCODE || '-' || SHOP.SNAME, salelist.saledate, PIZZA.PCODE, SALELIST.AMOUNT, PIZZA.COST * SALELIST.AMOUNT AS TOTAL_COST 
FROM tbl_pizza_01 PIZZA, tbl_salelist_01 SALELIST, tbl_shop_01 SHOP 
WHERE SALELIST.SCODE = SHOP.SCODE 
AND SALELIST.PCODE = PIZZA.PCODE;
ORDER BY SALELIST.SALENO;

SELECT SHOP.SCODE, sum(pizza.cost * salelist.amount) as total_cost
FROM tbl_pizza_01 PIZZA, tbl_salelist_01 SALELIST, tbl_shop_01 SHOP 
WHERE SALELIST.SCODE = SHOP.SCODE 
AND SALELIST.PCODE = PIZZA.PCODE
GROUP BY SHOP.SCODE

SELECT PIZZA.PNAME, sum(PIZZA.COST * salelist.amount) as total_cost
FROM tbl_pizza_01 PIZZA, tbl_salelist_01 SALELIST
WHERE SALELIST.PCODE = PIZZA.PCODE
GROUP BY PIZZA.PNAME
ORDER BY TOTAL_COST DESC

-- 
CREATE TABLE product (
    product_id  number(10) NOT NULL PRIMARY KEY,
    name varchar2(40),
    price number(10),
    category_id number(10) NOT NULL
);

CREATE TABLE category (
    category_id number(10) NOT NULL PRIMARY KEY,
    name varchar2(20)
);

CREATE TABLE sale (
    sale_id number(10) NOT NULL PRIMARY KEY,
    product_id number(10) NOT NULL,
    purchase_date date,
    sale_price number(10) NOT NULL,
    amount number(5) NOT NULL
);

CREATE SEQUENCE product_SEQ
INCREMENT BY 1
START WITH 1;

INSERT INTO product VALUES(product_SEQ.NEXTVAL,'컴퓨터','1000000','1');
INSERT INTO product VALUES(product_SEQ.NEXTVAL,'태블릿 PC','800000','1');
INSERT INTO product VALUES(product_SEQ.NEXTVAL,'핸드폰','1200000','1');
INSERT INTO product VALUES(product_SEQ.NEXTVAL,'헤드셋','80000','1');
INSERT INTO product VALUES(product_SEQ.NEXTVAL,'무선 이어폰','210000','1');
INSERT INTO product VALUES(product_SEQ.NEXTVAL,'책상','160000','2');
INSERT INTO product VALUES(product_SEQ.NEXTVAL,'의자','90000','2');
INSERT INTO product VALUES(product_SEQ.NEXTVAL,'소고기','12000','3');
INSERT INTO product VALUES(product_SEQ.NEXTVAL,'티셔츠','58000','4');

CREATE SEQUENCE category_SEQ
INCREMENT BY 1
START WITH 1;

INSERT INTO category VALUES(category_SEQ.NEXTVAL,'전자제품');
INSERT INTO category VALUES(category_SEQ.NEXTVAL,'가구');
INSERT INTO category VALUES(category_SEQ.NEXTVAL,'식품');
INSERT INTO category VALUES(category_SEQ.NEXTVAL,'의류');

CREATE SEQUENCE sale_SEQ
INCREMENT BY 1
START WITH 1;

INSERT INTO sale VALUES(sale_SEQ.NEXTVAL,'1', '20200101', '1000000','1');
INSERT INTO sale VALUES(sale_SEQ.NEXTVAL,'2', '20200101', '1600000','2');
INSERT INTO sale VALUES(sale_SEQ.NEXTVAL,'1', '20200101', '2000000','2');
INSERT INTO sale VALUES(sale_SEQ.NEXTVAL,'4', '20200102', '240000','3');
INSERT INTO sale VALUES(sale_SEQ.NEXTVAL,'5', '20200104', '210000','1');
INSERT INTO sale VALUES(sale_SEQ.NEXTVAL,'6', '20200106', '320000','2');
INSERT INTO sale VALUES(sale_SEQ.NEXTVAL,'7', '20200111', '360000','4');
INSERT INTO sale VALUES(sale_SEQ.NEXTVAL,'8', '20200115', '60000','5');
INSERT INTO sale VALUES(sale_SEQ.NEXTVAL,'9', '20200117', '58000','1');
INSERT INTO sale VALUES(sale_SEQ.NEXTVAL,'9', '20200120', '580000','10');
INSERT INTO sale VALUES(sale_SEQ.NEXTVAL,'2', '20200121', '1600000','2');
INSERT INTO sale VALUES(sale_SEQ.NEXTVAL,'1', '20200122', '1000000','1');
INSERT INTO sale VALUES(sale_SEQ.NEXTVAL,'4', '20200124', '80000','1');
INSERT INTO sale VALUES(sale_SEQ.NEXTVAL,'5', '20200126', '210000','1');
INSERT INTO sale VALUES(sale_SEQ.NEXTVAL,'6', '20200129', '160000','1');

SELECT SALE.SALE_ID, PRODUCT.NAME, sale.purchase_date,SALE.AMOUNT * product.price, SALE.AMOUNT FROM SALE, PRODUCT 
WHERE sale.product_id = product.product_id

SELECT PRODUCT.NAME, SUM(SALE.AMOUNT * product.price), SUM(SALE.AMOUNT) FROM SALE, PRODUCT 
WHERE sale.product_id = product.product_id
GROUP BY product.product_id, PRODUCT.NAME

SELECT category.name, SUM(sale.sale_price) ,SUM(SALE.AMOUNT)
FROM SALE, PRODUCT, CATEGORY
WHERE category.category_id = product.category_id
AND product.product_id = sale.product_id
GROUP BY category.name, category.category_id
ORDER BY category.category_id

SELECT product.product_id FROM PRODUCT
WHERE product.name = '태블릿 PC'
GROUP BY product.product_id

SELECT product.price FROM PRODUCT
WHERE product.name = '태블릿 PC'
GROUP BY product.price

-- 

CREATE TABLE TBL_ARTIST_201905 (
    ARTIST_ID CHAR(4) NOT NULL PRIMARY KEY,
    ARTIST_NAME VARCHAR2(20),
    ARTIST_BIRTH CHAR(8),
    ARTIST_GENDER CHAR(1),
    TALENT CHAR(1),
    AGENCY VARCHAR(30)
);

CREATE TABLE TBL_MENTO_201905 (
    MENTO_ID CHAR(4) NOT NULL PRIMARY KEY,
    MENTO_NAME VARCHAR2(20)
);

CREATE TABLE TBL_POINT_201905 (
    SERIAL_NO NUMBER(8) NOT NULL PRIMARY KEY,
    ARTIST_ID CHAR(4),
    MENTO_ID CHAR(4),
    POINT NUMBER(3)
);

INSERT INTO TBL_ARTIST_201905 VALUES('AA01','김스타','19970101','F','1','A엔터테이먼트')
INSERT INTO TBL_ARTIST_201905 VALUES('AA02','조스타','19980201','M','2','B엔터테이먼트')
INSERT INTO TBL_ARTIST_201905 VALUES('AA03','왕스타','19900301','M','3','C엔터테이먼트')
INSERT INTO TBL_ARTIST_201905 VALUES('AA04','정스타','20000401','M','1','D엔터테이먼트')
INSERT INTO TBL_ARTIST_201905 VALUES('AA05','홍스타','20010501','F','2','E엔터테이먼트')

INSERT INTO TBL_MENTO_201905 VALUES('J001','함멘토')
INSERT INTO TBL_MENTO_201905 VALUES('J002','박멘토')
INSERT INTO TBL_MENTO_201905 VALUES('J003','장멘토')

INSERT INTO TBL_POINT_201905 VALUES('2019001','A001','J001','78')
INSERT INTO TBL_POINT_201905 VALUES('2019002','A001','J002','76')
INSERT INTO TBL_POINT_201905 VALUES('2019003','A001','J003','60')
INSERT INTO TBL_POINT_201905 VALUES('2019004','A002','J001','80')
INSERT INTO TBL_POINT_201905 VALUES('2019005','A002','J002','72')
INSERT INTO TBL_POINT_201905 VALUES('2019006','A002','J003','78')
INSERT INTO TBL_POINT_201905 VALUES('2019007','A003','J001','90')
INSERT INTO TBL_POINT_201905 VALUES('2019008','A003','J002','92')
INSERT INTO TBL_POINT_201905 VALUES('2019009','A003','J003','88')
INSERT INTO TBL_POINT_201905 VALUES('2019010','A004','J001','96')
INSERT INTO TBL_POINT_201905 VALUES('2019011','A004','J002','90')
INSERT INTO TBL_POINT_201905 VALUES('2019012','A004','J003','98')
INSERT INTO TBL_POINT_201905 VALUES('2019013','A005','J001','88')
INSERT INTO TBL_POINT_201905 VALUES('2019014','A005','J002','86')
INSERT INTO TBL_POINT_201905 VALUES('2019015','A005','J003','86')


SELECT point.serial_no, point.artist_id, artist.artist_name, artist.artist_birth, POINT.POINT, mento.mento_name FROM tbl_artist_201905 ARTIST, tbl_point_201905 POINT, tbl_mento_201905 MENTO
WHERE point.artist_id = ARTIST.ARTIST_id
AND mento.mento_id = point.mento_id
order by point.artist_id, artist_name, point.point desc

SELECT artist.artist_id, artist.artist_name, SUM(POINT.POINT) AS sumpoint, avg(point.point) FROM tbl_artist_201905 artist, tbl_point_201905 POINT, tbl_mento_201905 mento
WHERE artist.artist_id = POINT.artist_id
AND mento.mento_id = POINT.mento_id
GROUP BY artist.artist_id, artist.artist_name
ORDER BY sumpoint desc

-- 

CREATE TABLE TBL_PIZZA_01 (
    pcode char(4) NOT NULL, PRIMARY KEY,
    pname varchar2(30),
    cost number(7)
);

CREATE TABLE TBL_SHOP_01 (
    scode char(4) NOT NULL, PRIMARY KEY,
    sname varchar2(20),
);

CREATE TABLE TBL_SALELIST_01 (
    saleno number(7) NOT NULL, PRIMARY KEY,
    scode char(4) NOT NULL,
    saledate date,
    pcode char(4) NOT NULL,
    amount number(5)
);